% Template for Doctoral Theses at Uppsala
% University. The template is based on
% the layout and typography used for
% dissertations in the Acta Universitatis
% Upsaliensis series
% Ver 5.2 - 2012-08-08
% Latest version available at:
%   http://ub.uu.se/thesistemplate
%
% Support: Wolmar Nyberg Akerstrom
% Thesis Production
% Uppsala University Library
% avhandling@ub.uu.se
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Radial Basis Function generated Finite Difference Methods for Pricing Financial Derivatives
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%
% Chosen: Berling as the main font and Pazo as the math font with Gill Sans for Sammanfattning and Преглед.
% Alternative: Palatino as the main font and Pazo as the math font or Computer Modern for all.
%%%

\documentclass{UUThesisTemplate}

% Package to determine wether XeTeX is used
\usepackage{ifxetex}

\ifxetex
    % XeTeX specific packages and settings
    % Language, diacritics and hyphenation
    \usepackage{polyglossia}
    \usepackage{fontspec,xltxtra,xunicode}
    \defaultfontfeatures{Mapping=tex-text}

    % Berling with Pazo
    \setsansfont[Ligatures=TeX]{Gill Sans}
    \setmainfont[
    	Ligatures=TeX,
        Extension=.ttf,
        BoldFont=BerlingBold,
        ItalicFont=BerlingItalic,
        BoldItalicFont=BerlingBold_Italic,
    ]{Berling}
    \renewcommand{\baselinestretch}{1.2} % Line width to support inline math!
    \usepackage{mathpazo} % I like this one the most for math!
%%    \usepackage{mathpple}

%    % Palatino with Pazo
%    \setmainfont{Palatino}
%    \renewcommand{\baselinestretch}{1.2} % Line width to support inline math!
%    \usepackage{mathpazo} % I like this one the most for math!
%%    \usepackage{mathpple}

    
%    % Computer Modern
%    \setmainfont[
%          Ligatures=TeX,
%          Extension=.otf,
%          BoldFont=cmunbx,
%          ItalicFont=cmunti,
%          BoldItalicFont=cmunbi,
%    ]{cmunrm}


    \setmainlanguage{english}
    \setotherlanguages{serbian, swedish}
    \setkeys{serbian}{script=Cyrillic}
    
    % Summary fonts
%    \newfontfamily\cyrillicfont[Script=Cyrillic]{Gill Sans Light}
%    \newfontfamily\swedishfont{Gill Sans Light}
    
    \newfontfamily\cyrillicfont[Script=Cyrillic]{Gill Sans}
    \newfontfamily\swedishfont{Gill Sans}
    
    \newfontfamily\myfont{Gill Sans}
    
    \newfontfamily\noteunic{Gill Sans Light}
    \DeclareTextFontCommand{\bibnamefont}{\noteunic}
    
    
%    \newfontfamily\cyrillicfont[Script=Cyrillic]{Palatino}
%    \newfontfamily\swedishfont{Palatino}
    
    
    % Font settings
%    \setmainfont{Times New Roman}
%    \setromanfont{Times New Roman}
%    \setsansfont{Arial}
%    \setmonofont{Courier New}

\usepackage{commath}
\usepackage{mathtools}
\newtagform{brackets}{\rmfamily{(}}{\rmfamily{)}}
\usetagform{brackets}
%\renewcommand{\theequation}{{\rmfamily\arabic{equation}}}
\renewcommand{\theequation}{\rmfamily{\arabic{chapter}.\arabic{equation}}}
\renewcommand{\thetable}{\rmfamily{\arabic{table}}}
\renewcommand{\thefigure}{\rmfamily{\arabic{table}}}

\else
    % Plain LaTeX specific packages and settings
    % Language, diacritics and hyphenation
    % Use English and Swedish languages.
    \usepackage[swedish,english]{babel}

    % Font settings
    \usepackage{type1cm}
    \usepackage[latin1]{inputenc}
    \usepackage[T1]{fontenc}
    \usepackage{mathptmx}


    % Enable scaling of images on import
    \usepackage{graphicx}
\fi
\usepackage{amsmath}

% Tables
\usepackage{booktabs}
\usepackage{tabularx}
\makeatletter
\def\hlinewd#1{%
\noalign{\ifnum0=`}\fi\hrule \@height #1 %
\futurelet\reserved@a\@xhline}
\makeatother

\usepackage{float}
\usepackage{pgfplots}
\usepackage{tikz}
\usepackage{tikzsymbols}
\pgfplotsset{compat=1.15}
\graphicspath{{figures/}}

% Document links and bookmarks
\usepackage{hyperref}

% Numbering of headings down to the subsection level
\numberingdepth{subsection}

% Including headings down to the subsection level in contents
\contentsdepth{subsection}

% Uncomment to use a custom abstract dummy text
\abstractdummy{
    \begin{abstract}
        Please use no more than 300 words and avoid mathematics or complex script.
    \end{abstract}
}


\begin{document}
\frontmatter
    % Creates the front matter (title page(s), abstract, list of papers)
    % for either a Comprehensive Summary or a Monograph.
    % Authors of Comprehensive Summaries use this front matter
    \frontmatterCS
    % Monograph authors use this front matter
    %\frontmatterMonograph

   % Optional dedication
   \dedication{``These violent delights have violent ends''\\(Romeo and Juliet: Act 2, Scene 6, Line 9)}

% Environment used to create a list of papers   
    \begin{listofpapers}
    \item Radial Basis Function generated Finite Differences for Option Pricing Problems \cite{paper1}. \label{paper1}
    \item BENCHOP --- The BENCHmarking Project in Option Pricing  \label{paper2}
    \item BENCHOP-SLV: The BENCHmarking project in Option Pricing --- Stochastic and Local Volatility problems \label{paper4}
    \item Pricing Derivatives under Multiple Stochastic Factors by Localized Radial Basis Function Methods \label{paper3}
    \item Pricing Financial Derivatives using Radial Basis Function generated Finite Differences with Polyharmonic Splines on Smoothly Varying Node Layouts \label{paper5}
    \item SMOOTHING PAPER TITLE \label{paper6}
    \end{listofpapers}


    \begingroup
        % To adjust the indentation in your table of contents, uncomment and enter the widest numbers for each level
        %  E.g.  \settocnumwidth{widest chapter number}{widest section number}{widest subsection number}...{...}
       %  \settocnumwidth{5}{4}{5}{3}{3}{3}
        \tableofcontents
    \endgroup

    % Optional tables
    %\listoftables
    %\listoffigures
\mainmatter
    % This includes the "Instruction", "Problem and Solutions" and "Example" files. After reading it, remove it from Thesis.tex.
%    \input{Example/Instruction.tex}
%    \input{Example/ProblemsAndSolutions}
%    \input{Example/Example.tex}

    % Include your chapters here.
%    \input{Introduction.tex}
%
%
%%%
%\par
%\noindent abcde­fghijklmnopqrstu­vwxyz­abcde­fghijklmnopqrstu­vwxyz­abcdabcde­fghijklmnopqrstu­vwxya\\
%bcde­fghijklmnopqrstu­vwxyz­abcde­fghijklmnopqrstu­vwxyz­abcdabcde­fghijklmnopqrstu­vwxyab\\%max=90
%cde­fghijklmnopqrstu­vwxyz­abcde­fghijklmnopq\\%min=45
%rstu­vwxyz­abcdabcde­fghijklmnopqrstu­vwxfdasdadadasdadaadadadaa%64 current
%\addtolength{\jot}{0.3em}
\chapter{Introduction}
\label{ch:introduction}
\par The purpose of this thesis is to report on state of the art in Radial Basis Function generated Finite Difference (RBF-FD) methods for pricing of financial derivatives. Based on the six appended papers \cite{paper1,paper2,paper3,paper4,paper5,paper6}, this work provides a detailed overview of RBF-FD properties and challenges that arise when the RBF-FD methods are used in financial applications. Moreover, with this manuscript, we aim to motivate further development of RBF-FD for finance.
\par Across the financial markets of the world, financial derivatives such as futures, options, and others, are traded in substantial volumes. The value of all assets that underly outstanding derivatives transactions is several times larger than the gross world product (GWP). Financial derivatives are the most commonly used instruments when it comes to hedging risks, speculation based investing, and performing arbitrage. Therefore, knowing the prices of those financial instruments is of utmost importance at any given time. In order to make that possible in practice, it is often required to employ a set of skills incorporating knowledge in financial theory, engineering methods, mathematical tools, and programming practice --- which altogether constitute the field known as \emph{financial engineering}. 
\par Many of theoretical pricing models for financial derivatives can be represented using partial differential equations (PDEs). In many cases, those equations are time-dependent, of high spatial dimensions, and with challenging boundary conditions --- which most often makes them analytically unsolvable. In those cases, we need to utilize numerical approximation as a mean of estimating their solution. The field of \emph{numerical analysis} is concerned with obtaining approximate solutions while maintaining reasonable bounds on errors. Unfortunately, there is no universal numerical method which could be used to solve all problems of this type efficiently. In fact, there are tremendously many numerical methods for solving different types of differential equations, and all those methods are featured with their own limitations in performance, stability, and accuracy --- mostly dependent on details of the problems they aim to solve. Therefore, carefully selecting and developing numerical methods for particular applications has been the only way to build efficient PDE solvers in ongoing practice. 
\par RBF-FD is a recent numerical method with potential to efficiently approximate solutions of PDEs in finance. Over the past years, besides the purely academic development and research of its numerical properties, the method has been mainly applied for simulations of atmospheric phenomena. As its name suggests, the RBF-FD method is of a finite difference type, from the radial basis function family. As a finite difference method, RBF-FD approximates differential equations by linear systems of algebraic equations, known as difference equations. Radial basis functions (RBFs) are used as interpolants that enable local approximations of differential operators that are necessary for constructing the difference equations. Constructed like that, the method is featured with a sparse matrix of the linear system of difference equations, and it is relatively simple to implement like the standard finite difference methods. Moreover, the method is mesh-free, meaning that it does not require a structured discretization of the computational domain which makes it equally easy to use in spaces of different dimensions, and it is of a customizable order of accuracy --- which are the features it inherits from the global radial basis function approximations. It is those properties that led us to recognize RBF-FD as a method with high potential for efficiently solving some analytically unfeasible and computationally challenging pricing problems in finance.
\par Nevertheless, being a young method, RBF-FD is still under intense development and we face many challenges when moving from simple theoretical cases toward more complex real-world applications. The core of this thesis deals with finding solutions for overcoming obstacles when financial derivatives are priced using RBF-FD to solve PDEs with several spatial dimensions. Thus, it represents a contribution to making the RBF-FD methods more reliable and efficient for use in financial applications. 
\par The rest of this manuscript is organized as follows. We introduce and define financial derivatives in Chapter \ref{ch:finder}. An overview of some popular financial models and techniques for the pricing of options are presented in Chapter \ref{ch:optionpricing}. We present the features and properties of RBF-FD methods for solving PDEs in finance in Chapter \ref{ch:rbffd}. Finally, we conclude with some unsolved challenges and suggestions for further development of the RBF-FD method for financial applications in Chapter \ref{ch:outlook}.
%
%
%%%
\chapter{Financial Derivatives}
\label{ch:finder}
\par A \emph{financial derivative} is a market instrument whose value depends on the values of some other underlying variables. Most often, those underlying variables are the prices of another traded asset (e.g., a stock underlying stock options), but they may as well be almost any variables of stochastic nature (e.g., air temperatures underlying weather derivatives). There are numerous financial derivatives in existence, available for almost every type of investment asset, ranging from agricultural grains to cryptocurrencies. Futures and options are best known as \emph{exchange-traded} derivatives, standardized to be bought and sold on derivatives exchanges (e.g., Chicago Mercantile Exchange for futures and Chicago Board Options Exchange for options). On the other hand, much greater volumes of financial derivatives are traded bilaterally \emph{over-the-counter} in a highly customizable fashion. This gave birth to many contracts with tailored properties such as forward contracts, swaps, exotic options, and other custom financial instruments.
\par When it comes to traders, three categories can be readily identified: \emph{hedgers}, \emph{speculators}, and \emph{arbitrageurs} \cite{hull2017options}. Hedgers use derivatives to reduce risks from potential future movements in a market variable, speculators use them to bet on the future outcome of a market variable, and arbitrageurs aim at making riskless profit by exploiting discrepancies in values of the same underlying variable traded under different derivatives or across different markets. Thanks to them, derivatives markets have been highly liquid over the past decades as many of the traders find trading derivatives more attractive compared to trading their underlying assets.
\par Financial derivatives are traded in extremely large volumes across the planet. %According to statistics maintained by Bank for International Settlements (BIS),% 
The estimated total notional value of these financial instruments has been above half a quadrillion of USD during the current decade \cite{bank2018annual}. That is about an order of magnitude larger than GWP \cite{worldgdp2018annual}. Moreover, derivatives markets have received great criticism due to their role in the most recent global financial crisis.  As a result of the crisis, strict regulations in trading of derivatives have been introduced in order to increase transparency on the markets, improve market efficiency, and reduce systemic risk. Now, in the post-crisis period, methods for valuation of financial derivatives are still under the spotlight of financial institutions, as they look for the most efficient ways to solve the mathematical problems stemming from the regulations.
\par In order to bring financial derivatives closer to the mathematical framework, it is useful for us to define several of their features. We assume that the contract representing a particular financial derivative is signed at time $t=t_0\equiv0$ and expires at $t=T$, where $T$ is also known as the time of \emph{maturity} of the contract. The contract is issued on the underlying stochastic variable $S(t)$. At the expiration of the contract, the holder receives payoff $g(S(T))$, which is equivalent to the value of the financial derivative at the time of maturity $T$, i.e., $u(S(T),T) = g(S(T))$. The value of the contract is represented by a function $u(t,S(t))$.
\par When it comes to hierarchy of financial derivatives, we can see most of them either as a type of a forward/futures contract, or as a type of an option. Therefore, it is common to study forwards and futures as binding contracts (i.e., $-\infty < g(S(T)) < \infty\ $), and options as non-obligatory contracts towards their holders (i.e., $0\leq g(S(T))<\infty$\ ). In the following sections, we consider them in more detail.
%
%%
\section{Forwards and Futures}
\label{sec:futures}
\par A \emph{forward} contract is an agreement between two parties signed at $t=t_0$ to buy or sell an underlying $S(t)$ at a certain future time $T$ for a certain price $K(t_0)=K_0$. The price $K(t)$ is called the \emph{forward price} of the contract, and it is determined at time $t_0$ in such a way that the value of the forward contract at the time of signing is equal to zero, i.e., $u(t_0,S(t_0))=u_0=0$. One of the parties in the contract takes a \emph{long} position and agrees to payoff 
$$g_l(S(T))=S(T)-K_0.$$
The other party assumes a \emph{short} position and agrees to sell $S(t)$ at the same time $T$ for the stipulated forward price $K_0$, effectively obliging to payoff 
$$g_s(S(T))=K_0-S(T).$$
Forward contracts are traded in over-the-counter markets and may be further customized according to the preferences of the signing parties.
\par A \emph{futures} contract is an exchange-traded, and thus standardized financial derivative, that is very similar to a forward contract. It is in agreement signed at no cost between two parties at $t=t_0$ to buy or sell an underlying $S(t)$ at a certain time $T$. The principal difference from the forward contract lies in the way in which the payments are realized. Namely, at every point in time $t_0 \leq t \leq T$, there exists a price $K(t)$, now called the \emph{futures price} of the contract, that is quoted on the exchange. At time $T$, the long position holder of the contract is entitled to the payoff 
$$g_l(S(T))=S(T)-K(T),$$
while the short position holder gets 
$$g_s(S(T))=K(T)-S(T).$$
Moreover, during an arbitrary time interval $(t_i,t_j]$, where $t_0 \leq t_i < t_j < T$, the long holder of the contract receives the amount $K(t_j)-K(t_i)$, and the short holder receives $K(t_i)-K(t_j)$. The futures price $K(t)$ evolves in such way that obtaining the futures contract at any time $t_0 \leq t \leq T$ should incur a zero cost, i.e., $u(t,S(t))=0$. 
\par As far as the pricing of forwards and futures is concerned, we should stress that these contracts are designed in such a way that their values are equal to zero at the signing. Thus, computational problems of interest here would be aimed at fairly determining the defined forward and futures prices. There are many stochastic techniques that successfully deal with these problems, and hence we do not put our main focus on them in this thesis. For more details on forwards and futures, it is wise to turn to \cite{hull2017options,duffie1989futures}.  
%
%%
\section{Options}
\label{sec:options}
\par An \emph{option} is a contract that gives its holder the right, but not the obligation to buy or sell an underlying $S(t)$ by a certain time of maturity $T$ for a certain price $K$. The price $K$ in the contract is known as the strike price. If the contract gives the buying right to its owner, then it is called a \emph{call} option, and if it gives the selling right, it is called a \emph{put} option. Call options are characterized with 
$$g_c(S(T))=\max(S(T)-K,\ 0),$$
and put options with 
$$g_p(S(T))=\max(K-S(T),\ 0),$$
as their respective payoff functions. Options that can be exercised at any time $t_0 < t \leq T$ are called \emph{American} options, and options that can be exercised only at time $t=T$ are known as \emph{European} options. Since options are traded both on exchanges and in over-the-counter markets, there are many more types of them (e.g., binary options, barrier options, Asian options, Bermudan options, and other exotic options) --- as the ways of customizing them are limitless. For instance, \emph{basket} options are defined in such a way that their payoffs may depend on more than one underlying asset, consequently requiring a multi-dimensional pricing model in order to estimate their value. An example of such a multi-asset derivative would be an arithmetic European call basket option issued on $D$ underlying assets $S_1,\ldots,S_D$, whose payoff function is 
$$g_{bc}(S_1,\ldots,S_D) = \max\left(\frac{1}{D}\sum_{d=1}^D S_d - K,\ 0\right).$$
Moreover, for a given underlying $S$, there may be a large number of options with different dates of expiration $T$ and different strike prices $K$.
\par Due to their versatility, options have been among the most popular financial derivatives on the financial markets, and many examples of their applications can be found in \cite{hull2017options}.
%
%
%%%
\chapter{Option Pricing}
\label{ch:optionpricing}
\par We should emphasize that an option gives the right to the holder to do something, and that the holder does not need to use that right. This is the main difference between options and other financial derivatives. Whereas it costs nothing to buy a forward or futures contract, there is always a non-negative price to acquiring an option. This very detail is the cornerstone of one of the most involving fundamental problems in financial markets, known as \emph{option pricing}. Depending on the option characteristics, the pricing problem can be as trivial as deriving an analytical pricing formula --- such is the case for the standard European call option with certain market assumptions. Nevertheless, in many other cases of option valuation, we are faced against an eternal struggle of balancing between reasonable market assumptions for deriving delicate mathematical models and developing efficient numerical solvers that are able to estimate the solutions of the equations posed by those models.
\par As the option gives stipulated rights, but not the obligations to their holder, it is natural to assume that this contract must have some objective non-negative value at any time. The central task of option pricing is to objectively determine the fair value of an option at any given time $t \leq T$. The fundamental mathematical framework for approaching this problem is the \emph{arbitrage theory}. In order to model option prices, the theory heavily relies on carefully argued assumptions about the market and mathematical ingredients such as martingale measures, stochastic differential equations (SDEs), It\^o calculus, Feynmann--Kac representations, and PDEs. We refer to these topics throughout the manuscript in limited capacity, as the detailed definitions and proofs can be found elegantly presented in \cite{bjork2009arbitrage}.
%
%%
\section{Market Models}
\label{sec:models}
\par In order to be able to price an option, we need a set of assumptions that we use to build a financial market model. The models range from the simple ones capturing a rough approximate picture of reality to extremely advanced ones aimed at capturing very fine details of the market. Once the model is defined, we should be able to set up an option pricing problem that needs to be solved in order to estimate the option value. Difficulty of such pricing problems strongly depends on complexity of the chosen market model as well as on complexity of the option that we want to price.  
%
\subsection{Black--Scholes--Merton Model}
\label{sub:bs}
\par We start by considering a plain European option on a stock that does not pay dividends, under the Black--Scholes--Merton model \cite{black73,merton73}. Creation of this model is considered as one of the most successful quantitative breakthroughs in social sciences, initiating a pricing framework that still keeps occupied thousands of researchers across financial institutions and universities of the world. The main feature of this model is that it allows the prices of European call and put options to be calculated analytically using variables that are either directly observable on the market or can be easily estimated. It is still widely used as a benchmark, although more advanced models have been developed over the years to take into account more realistic features of asset price dynamics, such as jumps and stochastic volatility.
\par The model consists of two assets, a riskless bond $B(t)$ and a risky stock $S(t)$, with dynamics given by the following SDEs.
\begin{align}
\dif B(t) &= r B(t) \dif t, \label{eq:bond} \\
\dif S(t) &= \mu S(t) + \sigma S(t) \dif W(t), \label{eq:stock}
\end{align}
where $r$ is the risk-neutral interest rate, $\mu$ is the drift coefficient, and $\sigma$ is the volatility of the stock --- all three being constant in the model. Moreover, $W(t)$ is the Wiener process.
\par The Black--Scholes--Merton model stands on several important assumptions. The main assumption is that the considered financial market is arbitrage free, meaning that it should not be possible to make positive earnings on the market without being exposed to risk. The next assumption states that the market should be complete and efficient, which means that every contract on the market can be hedged and that the market prices fully reflect all available information. Those assumptions allow us to determine a unique price of the option whose payoff function is $g(S(T))$, using the following valuation under the risk-neutral measure $\mathbb{Q}$.
\begin{equation}
\label{eq:mc}
u(S(t),t)=\exp\left(-r(T-t)\right)\mathbb{E}^{\mathbb{Q}}\left[g(S(T))\right],
\end{equation}
That effectively means that the expected value is calculated on an adapted dynamics, using $r$ instead of $\mu$ as the drift constant of the stochastic process $S(t)$ defined in \eqref{eq:stock}. 
\par Moreover, using the It\^o's lemma and the Feynmann--Kac theorem, we can equivalently express the option price as the solution of the following PDE, known as the Black--Scholes--Merton equation.
\begin{align}
%{\displaystyle{\frac{\partial}{\partial t} u(s,t) + r s \frac{\partial} {\partial s} u(s,t) + \frac{1}{2} s^2 \sigma^2 \frac{\partial^2}{\partial s^2} u(s,t) - r u(s,t)}} &=& 0,\\
\frac{\partial u}{\partial t} + r s \frac{\partial u} {\partial s} + \frac{1}{2} s^2 \sigma^2 \frac{\partial^2 u}{\partial s^2} - r u &= 0, \nonumber \\
u(s,T) &= g(s), \label{eq:bs}
\end{align}
where $s$ is the deterministic representation of the stochastic asset price $S$. The equation \eqref{eq:bs} is a parabolic PDE that has an analytical solution $u=u(s,t)$ in case of European call and put options. %Otherwise, the option price $u(s,t)$ can be numerically approximated by integration backward in time.
\par In order to to make better trading decisions, investors often look at the hedging parameters, which are also known as the \emph{greeks}. The most commonly used ones are delta $\Delta = \frac{\partial u}{\partial s}$, gamma $\Gamma = \frac{\partial^2 u}{\partial s^2}$, and vega $\nu = \frac{\partial u}{\partial \sigma}$. As these hedging parameters represent risk sensitivities, being able to compute them is of great importance.
\par We can use this basic framework to price financial derivatives with different payoffs or extend it in order to be able to valuate options with different underlying assets (e.g., stocks that pay discrete dividends). Also, we can further adapt the model to capture different market features more accurately (e.g., introduce local volatility instead of the constant one or model jumps by using the Merton model). A decent overview of such extensions of the Black--Scholes--Merton model can be seen in \cite{paper2}, while here we further consider how to apply this framework to pricing of basket options.
\par To price multi-asset options issued on $D$ underlying assets $S_1,S_2,\ldots,S_D$, we consider a multi-dimensional analogue to \eqref{eq:bond} and \eqref{eq:stock}.
\begin{align}
\dif B(t)&=rB(t)\dif t, \nonumber \\
\dif S_1(t)&=\mu_1 S_1(t)\dif t+\sigma_1 S_1(t)\dif W_1(t), \nonumber \\
%\dif S_2(t)&=&\mu_2 S_2(t)\dif t+\sigma_2 S_2(t)\dif W_2(t),\\
\vdots \nonumber \\ 
\dif S_D(t)&=\mu_D S_D(t)\dif t+\sigma_D S_D(t)\dif W_D(t), \label{eq:multi}
\end{align}
where the Wiener processes are correlated such that $\dif W_i(t)\dif W_j(t)=\rho_{ij}\dif t$. In this high-dimensional setting, an option with payoff function $g(S_1(T),\ldots,S_D(T))$, can be priced from 
\begin{equation}
\label{eq:mcD}
u(S_1(t),\ldots,S_D(t),t)=\exp\left(-r(T-t)\right)\mathbb{E}^{{{\mathbb{Q}}}}_{t}[g(S_1(T),\ldots,S_D(T))],
\end{equation}
and the corresponding high-dimensional Black--Scholes--Merton equation reads as
%\begin{equation}\label{eq:bsD}
%\begin{array}{rcl}
%{\displaystyle{\frac{\partial u}{\partial t}+r\sum\limits_{i}^{D}s_i\frac{\partial u}{\partial{s_i}}+\frac{1}{2}\sum\limits_{i,j}^{D}\rho_{ij}\sigma_i\sigma_j s_is_j\frac{\partial^2u}{\partial s_i \partial s_j}-ru}}&=&0,\\
%{\displaystyle{u(s_1,\ldots,s_D,T)}}&=&g(s_1,\ldots,s_D).
%\end{array}
%\end{equation}
\begin{align}
\frac{\partial u}{\partial t}+\mathcal{L}_b u&=0, \nonumber \\
u(s_1,\ldots,s_D,T)&=g(s_1,\ldots,s_D), \label{eq:bsD}
\end{align}
where
\begin{equation}
\label{eqBSop}
\mathcal{L}_b u \equiv r\sum\limits_{i}^{D}s_i\frac{\partial u}{\partial{s_i}}+\frac{1}{2}\sum\limits_{i,j}^{D}\rho_{i,j}\sigma_i\sigma_j s_is_j\frac{\partial^2u}{\partial s_i \partial s_j}-ru.
\end{equation}
We observe \eqref{eq:bsD} as a time-dependent PDE with $D$ spatial dimensions.
\par When it comes to American options, since these financial derivatives can be exercised at any $t \leq T$, as opposed to the European options that can only be exercised at $t=T$, instead of using PDE as a model, we formulate the pricing task as a linear complementarity problem (LCP)
\begin{align}
\frac{\partial u}{\partial t}+\mathcal{L}_b u&\geq 0,\nonumber \\
u(s_1,\ldots, s_D,T)&\geq g(s_1,\ldots, s_D), \nonumber \\
\left( \frac{\partial u}{\partial t}+\mathcal{L}_b u\right)& \left(u(s_1,\ldots, s_D,T)-g(s_1,\ldots, s_D)\right)=0. \label{eqlcp}
\end{align}
%
\subsection{Multi-Factor Models}
\label{sub:multifactor}
\par Another direction in development of pricing models would be to include more stochastic factors. Models with multiple stochastic factors allow for better reproduction of market features compared to the standard Black--Scholes--Merton formulation, which is known to fall short in capturing fat tails of return distributions and volatility skews. Therefore, various models with local volatilities, local stochastic volatilities, stochastic interest rates, and their combinations have become increasingly popular. In this section, we present two models with multiple stochastic factors that are used for pricing options.
\par The attention to local volatility models started with \cite{dupire1994pricing}. The first multi-factor model that we introduce is the Heston model \cite{heston1993closed}, featured with a stochastic volatility. The adapted dynamics for this model is as follows.
\begin{align}
\dif S(t) & =  rS(t)\dif t + \sqrt{V(t)} S(t) \dif W_s(t), \label{qlsvSDE1} \\
\dif V(t) & =  \kappa(\eta-V(t))\dif t + \sigma \sqrt{V(t)}\dif W_v(t), \label{qlsvSDE2}
\end{align}
where $V(t)$ is the stochastic volatility, $\sigma$ is the constant volatility of volatility, $\kappa$ is the speed of mean reversion of the volatility process, $\eta$ is the mean reversion level, $r$ is the risk-free interest rate, $W_s(t)$ and $W_v(t)$ are correlated Wiener processes with constant correlation $\rho$, i.e., $\dif W_s(t) \dif W_v(t) = \rho \dif t$. By applying the It\^{o}'s lemma and the Feynman--Kac theorem, the PDE for the Heston model reads as
\begin{align}
\frac{\partial u}{\partial t}+\mathcal{L}_h u&=0, \nonumber \\
u(s,v,T) &= \max(s-K,\ 0), \label{hstPDE}
\end{align}
where
\begin{align}
\mathcal{L}_{h} u &\equiv \frac{1}{2}vs^2\frac{\partial^2 u}{\partial s^2} + \rho\sigma v s \frac{\partial^2 u}{\partial s\partial v} + \frac{1}{2}\sigma^2v\frac{\partial^2 u}{\partial v^2} \nonumber \\ 
               &+ rs\frac{\partial u}{\partial s} + \kappa(\eta-v)\frac{\partial u}{\partial v} - ru, \label{eqHSTop}
\end{align}
$s$ and $v$ are deterministic representations of the stochastic asset price and volatility processes, respectively.
\par The Heston--Hull--White model is an extension of the Heston stochastic volatility model. The improvement consists of adding a stochastic interest rate that follows the Hull--White process \cite{hull1990pricing}, as the interest rates on the market are not constant. Another notable property of the Hull--White model is that the interest rates can be negative, as nowadays happens in some economies. The adapted dynamics for this model is as follows.
\begin{align}
\dif S(t) & =  R(t)S(t)\dif t + \sqrt{V(t)}S(t)\dif W_s(t), \label{hhwSDE1} \\
\dif V(t) & =  \kappa(\eta-V(t))\dif t + \sigma_v \sqrt{V(t)}\dif W_v(t), \label{hhwSDE2} \\
\dif R(t) & = a(b-R(t))\dif t + \sigma_r\dif W_r(t), {\color{white} \sqrt{V(t)}} \label{hhwSDE3}
\end{align}
where $R_t$ is the stochastic interest rate, $a$ is the speed of mean reversion of the interest rate process, $b$ is its mean reversion level, $\sigma_r$ is its volatility,  $W_s(t)$, $W_v(t)$,  and $W_r(t)$ are correlated Wiener processes.
\par We can apply the It\^{o}'s lemma and the Feynman--Kac theorem to derive the pricing PDE
\begin{align}
\frac{\partial u}{\partial t}+\mathcal{L}_w u&=0, \nonumber \\
u(s,v,r,T) &= \max(s-K,\ 0), \label{hhwPDE}
\end{align}
where
\begin{align}
\mathcal{L}_{w} u &\equiv  \frac{1}{2}vs^2\frac{\partial^2 u}{\partial s^2} + \frac{1}{2}\sigma_v^2v\frac{\partial^2 u}{\partial v^2}  + \frac{1}{2}\sigma_r^2\frac{\partial^2 u}{\partial r^2} + \nonumber \\
                             & \rho_{sv}\sigma_v vs\frac{\partial^2 u}{\partial s\partial v} + \rho_{sr}\sigma_r \sqrt{v} s\frac{\partial^2 u}{\partial s\partial r} + \rho_{vr}\sigma_v\sigma_r \sqrt{v}\frac{\partial^2 u}{\partial v\partial r} + \nonumber \\
                             & rs\frac{\partial u}{\partial s} + \kappa(\eta-v)\frac{\partial u}{\partial v} + a(b-r)\frac{\partial u}{\partial r} - ru, \label{eqHHWop}
\end{align}
\par Here, it becomes clear how advanced models easily grow in complexity, which in turn makes it difficult both to calibrate and valuate them in practice. Several other multi-factor models are analyzed in more detail in \cite{paper3, paper5}. 
%
%%
\section{Pricing Methods}
\label{sec:methods}
\par For a small number of cases, such as plain European call or put options under the Black--Scholes--Merton model, calculating the option price can be done using analytical methods and developing closed form solutions. In some other cases it is possible to approximate the solutions using semi-analytical schemes. Commonly used methods for pricing of financial derivatives in the absence of analytical or semi-analytical solutions can be split in three categories \cite{paper2}. 
\par In the first category are the stochastic methods, such as Monte Carlo methods \cite{glasserman2013monte, longstaff2001valuing} and discrete time methods like binomial trees \cite{cox1979option, rendleman1979two}. These methods typically work by simulating stochastic trajectories of the underlying dynamics in order to estimate the expected values of the payoff function so that the option price can be computed. They are mostly used for multi-asset derivatives and multi-factor models which result in problems of high dimensionality, as they are simple to implement, but far less efficient compared to other methods when used for problems in smaller dimensions. 
\par The second category are deterministic methods such as finite differences \cite{tavella2000pricing}, and less often finite elements and finite volumes. The deterministic methods work by discretizing differential operators in the PDE formulation of the pricing models. The finite differences are often used for solving pricing problems of the dimensionality not larger than two.
\par The third category consists of methods based on Fourier transform, such as Carr--Madan fast Fourier transform method \cite{carr1999option}, and a more recent cosine series expansions method \cite{fang2008novel}. The methods from this category are extremely efficient, but typically require the existence of the density function or the characteristic function of the underlying process, in closed form --- which is not always available.
\par A common rule of thumb for selecting the option pricing method would be to check if it is possible to analytically calculate the solution to the pricing problem. In case that is not possible, then the next best option is a Fourier transform based method. Deterministic methods come into play as robust numerical schemes when Fourier methods are not applicable. Nevertheless, they often suffer from the curse of dimensionality as the degrees of freedom in the resulting approximations grow exponentially with the dimensionality of the problem. Therefore, if the pricing problem is of a higher dimensionality, Monte Carlo methods are the best alternative.
\par RBF methods are a more recent group of deterministic methods to be used for option pricing \cite{hon1999radial}. These methods have been becoming increasingly popular since they possess potential to cope with PDEs of moderately high dimensions. Typically, deterministic methods are used to solve problems of up to four dimensions, and often employ projection schemes to split the main problem into a set of problems of smaller dimensionality \cite{foulon2010adi}. However, in cases when the correlations between the stochastic processes are high, such procedures encounter severe difficulties. Thus, pricing problems of dimensionality greater than three are typically left to be solved by Monte Carlo methods. 
\par In this the following chapter we present a localized RBF method that could be an alternative to Monte Carlo methods for moderately high-dimensional problems.
%
%
%%%
\chapter{Radial Basis Function generated Finite Difference Methods}
\label{ch:rbffd}
\par The RBF-FD methods belong to the family of RBF methods. Using the RBF methods for approximating solutions of PDEs dates back to the beginning of the nineties in the previous century \cite{kansa1990multiquadrics2, kansa1990multiquadrics1}. Ever since, these methods have been applied in different fields, including financial engineering \cite{pettersson2008improved, fasshauer2004using, hon1999radial}. 
\par In order to apply the method, we observe option pricing problems on the truncated computational domain $\Omega\subset \mathbb{R}^{d}$ in the following PDE form
\begin{align}
\frac{\partial}{\partial t}u(t,\underline{x}) + \mathcal{L}u(t,\underline{x}) &= 0, \quad \underline{x} \in \Omega, \label{eqPDE} \\
\mathcal{B}u(t,\underline{x}) &= f(t,\underline{x}), \quad \underline{x} \in \partial \Omega, \label{eqBC}
\end{align}
where $u(t,\underline{x})$ is the option price; $\mathcal{L}$ is the differential operator of the model; $\mathcal{B}$ is the boundary differential operator and $f(t,\underline{x})$ is the forcing function, which together correspond to the boundary conditions for the pricing problem; $\underline{x}$ is the spatial variable representing underlying assets or stochastic factors and $t$ is the time variable.
\par To construct an RBF approximation, we scatter $N$ nodes $\underline{x}_j$, where $j=1,\ldots,N$, across the computational domain $\Omega$. Then, we consider an interpolant
\begin{equation}
\label{eq:RBFint}
	v(\underline{x}) = \sum_{j=1}^N \lambda_j \phi(\|\underline{x}-\underline{x}_j\|),
\end{equation}
where $\phi$ is the RBF, and $\lambda_j$ are the interpolation coefficients. It should be noted that the value of the interpolant at any point $\underline{x}$ only depends on the distance to the nodes and that this expression is valid in any number of dimensions. 
\begin{table}[!ht]
\begin{center}
\caption{{\rmfamily{Commonly used radial basis functions, where $\varepsilon\in \mathbb{R}^+$ is the shape parameter and $q\in\{2m-1, m \in \mathbb{N}\}$ is the polyharmonic spline degree.}}}
\begin{tabular}{ l  c  c  c  r  }
%\hline\hline
RBF & & &  & $\phi(r)$   \\ \hlinewd{1pt}
 Gaussian (GA) &  & &  &  $\exp{(-\varepsilon^2r^2)}$ \\
 Multiquadric (MQ) &  & &  & $\sqrt{1+\varepsilon^2r^2}$ \\
 Inverse Multiquadric (IMQ) & & &  & $1/\sqrt{1+\varepsilon^2r^2}$ \\
 Inverse Quadratic (IQ) & & &  & $1/(1+\varepsilon^2r^2)$ \\
 Polyharmonic Spline (PHS) & & &  & $r^q$\\
\hlinewd{1pt}
%\hline\hline
\end{tabular}
\label{TabRBF}
\end{center}
\end{table}
We can use this interpolant to approximate the solution of \eqref{eqPDE}, resulting in a dense linear system of equations which dominates the computational cost.
\begin{figure}[H]
\centering
\input{figures/GSplot.tikz}\hspace{1em}
\input{figures/PHSplot.tikz}
\caption{Polyharmonic splines of different odd degrees.}
\label{figRBF}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%
{\color{red}
\par {\huge\textbf{STOP}}
\par \noindent \rule{\textwidth}{2pt}}
\color{gray}
%%%%%%%%%%%%%%%%%%%%%%%

\par Even though the classic RBF methods (also known as global RBF methods) possess desirable properties such as high order convergence and mesh-free domain discretization, they are featured with dense system matrices which in many cases have very large condition numbers. To overcome these weaknesses, several localized RBF approaches were introduced, among which RBF-FD \cite{tolstykh2000using, wright2006scattered} and RBF-PU \cite{wendland2002fast} are the most popular and still actively developed.
%Given a set of $N$ nodes scattered across the computational domain $\Omega$ and a differential operator $\mathcal{L}$. 



\par To construct an RBF-FD approximation, we scatter $N$ nodes across the computational domain $\Omega$. For each node $\underline{x}_j$, we define an array of nodes $\mathbf{x}_j$ consisting of $n_j-1$ neighboring nodes and $\underline{x}_j$ itself, and consider it as a stencil of size $n_j$ centered at $\underline{x}_j$. The differential operator $\mathcal{L}$ defined in (\ref{eqPDE})  is approximated in every node  $\underline{x}_j$ as
\begin{equation}
\mathcal{L}u(\underline{x}_j)\approx\sum_{i=1}^{n_j}{w}_{j}^{i}u_j^{i}\equiv \mathbf{w}_ju(\mathbf{x}_j),\quad j=1,\ldots,N,
\label{eqRBFFD}
\end{equation}
where $u_j^{i}=u(\underline{x}_j^i)$ and $\underline{x}_j^i$ is a locally indexed node in $\mathbf{x}_j$, while $\mathbf{w}_j$ is the array of differentiation weights for the stencil centered at $\underline{x}_j$. In the standard RBF-FD methods, the weights ${w}_j^i$ are calculated by enforcing (\ref{eqRBFFD}) to be exact for RBFs centered at each of the nodes in $\mathbf{x}_j$ yielding
\begin{equation}
\label{eqRBFFDmat}
{\footnotesize{
\left[\begin{array}{cccc}
\phi(\|\underline{x}_j^{1}-\underline{x}_j^{1}\|) & \ldots & \phi(\|\underline{x}_j^{1}-\underline{x}_{j}^{n_j}\|)\\
\vdots & \ddots & \vdots\\
\phi(\|\underline{x}_{j}^{n_j}-\underline{x}_j^{1}\|) & \ldots & \phi(\|\underline{x}_{j}^{n_j}-\underline{x}_{j}^{n_j}\|)
\end{array}\right]
\left[\begin{array}{c}
{w}_j^{1}\\
\vdots\\
{w}_{j}^{n_j}
\end{array}\right]=
\left[\begin{array}{c}
\mathcal{L}\phi(\|\underline{x}_{j}-\underline{x}_j^{1}\|)\\
\vdots \\
\mathcal{L}\phi(\|\underline{x}_{j}-\underline{x}_{{j}}^{n_j}\|)
\end{array}\right].}}
\end{equation}
In theory on RBF interpolation, it is known that (\ref{eqRBFFDmat}) forms a nonsingular system of equations. Therefore, a unique set of weights can be computed for each node. We arrange those weights in a differentiation matrix $L$ in order to build a discrete spatial operator that approximates $\mathcal{L}$. Since $n_j \ll N$, the resulting differentiation matrix is sparse.
\section{Choosing Shape Parameters}
Paper I
%
%%
\section{Role of Polynomials}
Many RBFs (e.g., Gaussian, multiquadric, inverse quadratic) were considered for approximating differential operators in the literature. Although such approximations are featured with great properties, the linear systems of equations that need to be solved in order to obtain the weights $w_j^i$ are often ill-conditioned. Several past works \cite{davydov2011adaptive, fornberg2011stabilization, flyer2012guide, larsson2013stable, fornberg2013stable, flyer2016enhancing} addressed this problem by adding low-order polynomials together with RBFs into the presented interpolation. Moreover, the shape parameter, which is present in most of the RBFs, needs to be chosen carefully in order to have a stable approximation. The problem of choosing the shape parameter for Gaussian-based RBF-FD schemes is thoroughly examined for option pricing problems in \cite{paper1}, but still remains unsolved for general applications.
\par
Nevertheless, recent developments \cite{bayona2017role, flyer2016on}, show that the RBF-FD approximation can be greatly improved by using high order polynomials together with PHSs as RBFs in the interpolation. With that approach, it seems as if the polynomial degree takes the role of controlling the rate of convergence. This allows us to use piecewise smooth PHSs as RBFs without a shape parameter, since the approximation accuracy is no longer controlled by the smoothness of the RBFs. Still, the RBFs do contribute to reduction of approximation errors and they are necessary in order to have both stable and accurate approximation. We define the PHS function in \eqref{eqPHS} and show some examples in Figure \ref{figPHS}.%
\begin{equation}
\label{eqPHS}
\phi(r) =  
	\begin{cases}
		r^q, & q\in\{2k-1\}, \\
		r^q \ln(r), & q\in\{2k\},
	\end{cases}
\end{equation}
where $k \in \mathbb{N}$. The results in \cite{flyer2016on} show that there is no significant difference between using odd and even degrees of PHSs in practical applications of RBF-FD. Consequently, we use odd degrees due to their slightly simpler form.%
%\begin{figure}[H]
%\centering
%\input{figs/PHSplot.tikz}
%\caption{Polyharmonic splines of different odd degrees.}
%\label{figPHS}
%\end{figure}
\par
Taking everything into account, the linear system that we need to solve to obtain the differentiation weights for each node in our problems is
\begin{equation}
{\footnotesize{
\label{eq:D2}
\left[\begin{array}{cc}
A & P^T \\
P & 0 \\
\end{array}\right]
\left[\begin{array}{c}
{\mathbf{w}}_j\\
{\mathbf{g}}_j\\
\end{array}\right]=
\left[\begin{array}{c}
\mathcal{L}\phi(\|\underline{x}_{j}-\underline{x}_j^{1}\|)\\
\vdots \\
\mathcal{L}\phi(\|\underline{x}_{j}-\underline{x}_j^{n_j}\|)\\
\mathcal{L}p_1(\underline{x}_j)\\
\vdots\\
\mathcal{L}p_{m_j}(\underline{x}_j)
\end{array}\right],
}}
\end{equation}
where $A$ is the RBF matrix and $\mathbf{w}_j$ is the array of differentiation weights, both shown on the left-hand side of \eqref{eqRBFFDmat}; $P$ is the matrix of size $m_j \times n_j$ that contains all monomials up to order $p$ (corresponding to $m_j$ monomial terms) that are evaluated in each node $\underline{x}_j^i$ of the stencil $\mathbf{x}_j$ and $\mathbf{0}$ is a zero square matrix of size $m_j \times m_j$; $\mathbf{g}_j$ is the array of dummy weights that should be discarded and $\{p_1, p_2, \ldots, p_{m_j}\}$ is the array of monomial functions indexed by their position relative to the total number of monomial terms $m_j$, such that it contains all the combinations of monomial terms up to degree $p$.
\par
Compared to standard FD discretizations, where differential operators are approximated only on one-dimensional Cartesian grids, meaning that high-dimensional operators need to be discretized separately in each direction, in the RBF-FD approximations dimensionality does not make the problem more difficult. When it comes to the boundary nodes and the nodes that are close to the boundary, the nearest neighbor based stencils automatically form according to the shape of the boundary and require no special treatment for computing the differentiation weights. The only data that is required for approximation of differential operators are Euclidian distances between the nodes. This means that (\ref{eqRBFFDmat}) represents a way to approximate a differential operator in any number of dimensions. Although the FD weights can be directly derived and the RBF-FD weights need to be obtained by solving a small linear system for each node, this task is perfectly parallelizable and that extra cost can be well justified by the desirable features of the method.
\par
After the weights are computed and stored in the differentiation matrix, an approximation of (\ref{eqPDE}) can be presented in the form of the following semi-discrete equation
%\begin{equation}
%\label{eqdRBFFD}
%\left[\begin{array}{cc}
%E_{II} & 0_{IB} \\
%0_{BI} & 0_{BB} \\
%\end{array}\right]
%\frac{\mathrm{d}}{\mathrm{d} t}
%\left[\begin{array}{c}
%\underline{u}_I\\
%\underline{u}_B\\
%\end{array}\right] =
%\left[\begin{array}{cc}
%L_{II} & L_{IB} \\
%B_{BI} & B_{BB} \\
%\end{array}\right]
%\left[\begin{array}{c}
%\underline{u}_I\\
%\underline{u}_B\\
%\end{array}\right],
%\end{equation}
\begin{equation}
\label{eqdRBFFD}
\frac{\mathrm{d}}{\mathrm{d} t}\mathbf{u}=L\mathbf{u},
\end{equation}
where $\mathbf{u}\equiv u(\mathbf{x})$ is the discrete numerical solution of the pricing equation, while $\mathbf{x}$ is the array of all nodes in the computational domain. To compute the option price $\mathbf{u}$, we need to integrate \eqref{eqdRBFFD} in time.
%
%%
\section{Constructing Node Layouts}
Paper V
Cartesian, non-uniform, smoothly varying in 1D,2D,3D
%
%%
\section{Smoothing Payoff Functions}
Paper VI
%
%
%%%
\chapter{Outlook and Further Development}
\label{ch:outlook}
It works. It is not the best. It is still promisingly developing.
Write about the node placement in high-D!
\backmatter
    % References
    % No restriction is set to the reference styles
    % Save your references in References.bib
%    \nocite{*} % Remove this for your own citations
    \bibliographystyle{teza}
    \bibliography{References}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%    
{\myfont
\chapter*{\emph{Acknowledgments}}
{\noteunic
Woohoo!
}
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  
\begin{swedish}
\chapter*{\emph{Sammanfattning}}
{\noteunic
\par De yngre tyckte inte att de hade levt den dagen, om det på kvällen när de somnade inte susade i deras öron och flimrade för deras ögon av allt som de hade hört och sett under dagen. De yngre tyckte inte att de hade levt den dagen, om det på kvällen när de somnade inte susade i deras öron och flimrade för deras ögon av allt som de hade hört och sett under dagen. De yngre tyckte inte att de hade levt den dagen, om det på kvällen när de somnade inte susade i deras öron och flimrade för deras ögon av allt som de hade hört och sett under dagen. De yngre tyckte inte att de hade levt den dagen, om det på kvällen när de somnade inte susade i deras öron och flimrade för deras ögon av allt som de hade hört och sett under dagen.
\par De yngre tyckte inte att de hade levt den dagen, om det på kvällen när de somnade inte susade i deras öron och flimrade för deras ögon av allt som de hade hört och sett under dagen. De yngre tyckte inte att de hade levt den dagen, om det på kvällen när de somnade inte susade i deras öron och flimrade för deras ögon av allt som de hade hört och sett under dagen. De yngre tyckte inte att de hade levt den dagen, om det på kvällen när de somnade inte susade i deras öron och flimrade för deras ögon av allt som de hade hört och sett under dagen. De yngre tyckte inte att de hade levt den dagen, om det på kvällen när de somnade inte susade i deras öron och flimrade för deras ögon av allt som de hade hört och sett under dagen. De yngre tyckte inte att de hade levt den dagen, om det på kvällen när de somnade inte susade i deras öron och flimrade för deras ögon av allt som de hade hört och sett under dagen. De yngre tyckte inte att de hade levt den dagen, om det på kvällen när de somnade inte susade i deras öron och flimrade för deras ögon av allt som de hade hört och sett under dagen.
}
\end{swedish}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%    
\newpage
\begin{serbian}
\chapter*{\emph{Преглед}}
{\noteunic
\par \noindent Већим делом свога тока река Дрина протиче кроз тесне гудуре између стрмих планина или кроз дубоке кањоне окомито одсечених обала. Само на неколико места речног тока њене се обале проширују у отворене долине и стварају, било на једној било на обе стране реке, жупне, делимично равне, делимично таласасте пределе, подесне за обрађивање и насеља. Такво једно проширење настаје и овде, код Вишеграда, на месту где Дрина избија у наглом завоју из дубоког и уског теснаца који стварају Буткове Стијене и Узавничке планине. Заокрет који ту прави Дрина необично је оштар а планине са обе стране тако су стрме и толико ублизу да изгледају као затворен масив из којег река извире право, као из мрког зида. Али ту се планине одједном размичу у неправилан амфитеатар чији промер на најширем месту није већи од петнаестак километара ваздушне линије.
\par На том месту где Дрина избија целом тежином своје водене масе, зелене и запењене, из привидно затвореног склопа црних и стрмих планина, стоји велики и складно срезани мост од камена, са једанаест лукова широког распона. Од тог моста, као од основице, шири се лепезасто цела валовита долина, са вишеградском касабом и њеном околином, са засеоцима полеглим у превоје брежуљака, прекривена њивама, испашама и шљивицима, изукрштана међама и плотовима и пошкропљена шумарцима и ретким скуповима црногорице. Тако, посматрано са дна видика, изгледа као да из широких лукова белог моста тече и разлива се не само зелена Дрина него и цео тај жупни и питоми простор, са свим што је на њему и јужним небом над њим.
\par На десној обали реке, почињући од самог моста, налази се главнина касабе, са чаршијом, делом у равници, а делом на обронцима брегова. На другој страни моста, дуж леве обале, протеже се Малухино поље, раштркано предграђе око друма који води пут Сарајева. Тако мост, састављајући два краја сарајевског друма, веже касабу са њеним предграђем.
}
\end{serbian}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  

\end{document}
